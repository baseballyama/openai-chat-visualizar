import{h as le,a as A,t as V,c as m,s as t,f as ne}from"../chunks/disclose-version.Bzc4xlhG.js";import{r as k,n as I,p as ie,a as oe,C as s,s as p,W as n}from"../chunks/runtime.DtJnzEBV.js";import{b as T,e as E,s as O}from"../chunks/render.BTQBtVcH.js";import{p as x,i as $}from"../chunks/if.GshhNGg8.js";import{e as ue,i as ce}from"../chunks/each.Cx5oWuxk.js";import{r as ve}from"../chunks/attributes.B83Hhwwq.js";function P(e){le&&e.firstChild!==null&&(e.textContent="")}let H=!1;function de(e,_,u,i=u){e.addEventListener(_,u);const h=e.__on_r;h?e.__on_r=()=>{h(),i()}:e.__on_r=i,H||(H=!0,document.addEventListener("reset",q=>{Promise.resolve().then(()=>{var f;if(!q.defaultPrevented)for(const l of q.target.elements)(f=l.__on_r)==null||f.call(l)})},{capture:!0}))}function K(e,_,u){de(e,"input",()=>{u(J(e)?R(e.value):e.value)}),k(()=>{var i=_();e.__value=i,!(J(e)&&i===R(e.value))&&(e.type==="date"&&!i&&!e.value||(e.value=T(i)))})}function J(e){var _=e.type;return _==="number"||_==="range"}function R(e){return e===""?null:+e}var pe=V('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),_e=V('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),ge=V('<ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"> </li> <li class="svelte-1ruqg1j"><button class="svelte-1ruqg1j">Delete</button></li></ul>'),me=V('<p class="progress svelte-1ruqg1j"> </p>'),fe=V('<p class="openai-api-key svelte-1ruqg1j">OpenAI API key</p> <input placeholder="OpenAI API key" class="api-input svelte-1ruqg1j"> <p class="input-error svelte-1ruqg1j"> </p> <ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j">Sentence1</li> <li class="svelte-1ruqg1j">Sentence2</li> <li class="svelte-1ruqg1j">Cosine Similarity</li> <li class="svelte-1ruqg1j">Delete</li></ul> <!> <div class="buttons svelte-1ruqg1j"><button class="svelte-1ruqg1j">+ Add</button> <button class="execute-button svelte-1ruqg1j">Embeddings</button></div> <!>',1);function ke(e,_){oe(_,!0);let u=I(x(sessionStorage.getItem("openaiApiKey")||"")),i=I("");const h={};let q=I(0),f=I(0),l=I(x([{a:"",aVector:[],b:"",bVector:[],similarity:0}]));const W=()=>{p(l,x([...s(l),{a:"",aVector:[],b:"",bVector:[],similarity:0}]))},G=r=>{p(l,x(s(l).filter((a,o)=>o!==r)))},D=async r=>{if(h[r])return h[r];const c=(await(await fetch("https://api.openai.com/v1/embeddings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s(u)}`},body:JSON.stringify({input:r,model:"text-embedding-3-small"})})).json()).data[0].embedding;return h[r]=c,c},Q=(r,a)=>{const o=(v,g)=>{let d=0;for(let b=0;b<v.length;b++)d+=v[b]*g[b];return d},c=v=>{let g=0;for(let d=0;d<v.length;d++)g+=v[d]*v[d];return Math.sqrt(g)};return o(r,a)/(c(r)*c(a))},U=async()=>{if(p(q,x(s(l).length)),p(f,0),p(i,""),s(u)===""){p(i,"Please input your OpenAI API key");return}sessionStorage.setItem("openaiApiKey",s(u)),s(l).flatMap(async r=>{const[a,o]=await Promise.all([D(r.a),D(r.b)]);p(f,s(f)+1);const c=Q(a,o);r.aVector=a,r.bVector=o,r.similarity=c,p(l,x([...s(l)]))})};var L=fe(),X=ne(L),S=t(t(X,!0));ve(S);var M=t(t(S,!0)),Y=m(M),Z=t(t(M,!0)),N=t(t(Z,!0));ue(N,65,()=>s(l),ce,(r,a,o)=>{var c=ge(),v=m(c),g=m(v);P(g);var d=t(t(g,!0));$(d,()=>n(a).aVector.length>0,y=>{var j=pe();P(j),k(()=>j.value=`[${n(a).aVector.length>0&&n(a).aVector.join(", ")}]<`),A(y,j)});var b=t(t(v,!0)),C=m(b);P(C);var te=t(t(C,!0));$(te,()=>n(a).bVector.length>0,y=>{var j=_e();P(j),k(()=>j.value=`[${n(a).bVector.length>0&&n(a).bVector.join(", ")}]<`),A(y,j)});var F=t(t(b,!0)),ae=m(F);k(()=>O(ae,n(a).similarity===0?"(Not Embedded)":n(a).similarity.toFixed(6)));var re=t(t(F,!0)),se=m(re);K(g,()=>n(a).a,y=>n(a).a=y),K(C,()=>n(a).b,y=>n(a).b=y),E("click",se,()=>G(n(o)),!1),A(r,c)});var z=t(t(N,!0)),B=m(z),w=t(t(B,!0)),ee=t(t(z,!0));$(ee,()=>s(q)>0,r=>{var a=me(),o=m(a);k(()=>O(o,`${T(s(f))}/${T(s(q))} tasks completed`)),A(r,a)}),k(()=>O(Y,s(i))),K(S,()=>s(u),r=>p(u,r)),E("click",B,W,!1),E("click",w,U,!1),A(e,L),ie()}export{ke as component};
