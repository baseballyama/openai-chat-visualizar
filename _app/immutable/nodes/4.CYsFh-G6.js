import{h as se,j as le,a as A,t as V,c as m,s as t,f as ne}from"../chunks/disclose-version.qmuNnzyg.js";import{r as x,n as I,C as s,s as p,$ as l}from"../chunks/runtime.BIWlThYV.js";import{b as T,e as C,s as E}from"../chunks/render.CKQd4rFi.js";import{p as q,i as O}from"../chunks/if.DXgWr819.js";import{e as ie,i as oe}from"../chunks/each.cMakErTO.js";import{r as ue}from"../chunks/attributes.BHiWTH-U.js";function P(e){se&&e.firstChild!==null&&le(e)}let H=!1;function ce(e,n,_,o=_){e.addEventListener(n,_);const h=e.__on_r;h?e.__on_r=()=>{h(),o()}:e.__on_r=o,H||(H=!0,document.addEventListener("reset",f=>{Promise.resolve().then(()=>{var i;if(!f.defaultPrevented)for(const k of f.target.elements)(i=k.__on_r)==null||i.call(k)})},{capture:!0}))}function K(e,n,_){ce(e,"input",()=>{_(J(e)?R(e.value):e.value)}),x(()=>{var o=n();e.__value=o,!(J(e)&&o===R(e.value))&&(e.type==="date"&&!o&&!e.value||(e.value=T(o)))})}function J(e){var n=e.type;return n==="number"||n==="range"}function R(e){return e===""?null:+e}var ve=V('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),de=V('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),pe=V('<ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"> </li> <li class="svelte-1ruqg1j"><button class="svelte-1ruqg1j">Delete</button></li></ul>'),_e=V('<p class="progress svelte-1ruqg1j"> </p>'),ge=V('<p class="openai-api-key svelte-1ruqg1j">OpenAI API key</p> <input placeholder="OpenAI API key" class="api-input svelte-1ruqg1j"> <p class="input-error svelte-1ruqg1j"> </p> <ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j">Sentence1</li> <li class="svelte-1ruqg1j">Sentence2</li> <li class="svelte-1ruqg1j">Cosine Similarity</li> <li class="svelte-1ruqg1j">Delete</li></ul> <!> <div class="buttons svelte-1ruqg1j"><button class="svelte-1ruqg1j">+ Add</button> <button class="execute-button svelte-1ruqg1j">Embeddings</button></div> <!>',1);function qe(e){let n=I(q(sessionStorage.getItem("openaiApiKey")||"")),_=I("");const o={};let h=I(0),f=I(0),i=I(q([{a:"",aVector:[],b:"",bVector:[],similarity:0}]));const k=()=>{p(i,q([...s(i),{a:"",aVector:[],b:"",bVector:[],similarity:0}]))},G=r=>{p(i,q(s(i).filter((a,u)=>u!==r)))},D=async r=>{if(o[r])return o[r];const c=(await(await fetch("https://api.openai.com/v1/embeddings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s(n)}`},body:JSON.stringify({input:r,model:"text-embedding-3-small"})})).json()).data[0].embedding;return o[r]=c,c},Q=(r,a)=>{const u=(v,g)=>{let d=0;for(let b=0;b<v.length;b++)d+=v[b]*g[b];return d},c=v=>{let g=0;for(let d=0;d<v.length;d++)g+=v[d]*v[d];return Math.sqrt(g)};return u(r,a)/(c(r)*c(a))},U=async()=>{if(p(h,q(s(i).length)),p(f,0),p(_,""),s(n)===""){p(_,"Please input your OpenAI API key");return}sessionStorage.setItem("openaiApiKey",s(n)),s(i).flatMap(async r=>{const[a,u]=await Promise.all([D(r.a),D(r.b)]);p(f,s(f)+1);const c=Q(a,u);r.aVector=a,r.bVector=u,r.similarity=c,p(i,q([...s(i)]))})};var L=ge(),W=ne(L),S=t(t(W,!0));ue(S);var M=t(t(S,!0)),X=m(M),Y=t(t(M,!0)),N=t(t(Y,!0));ie(N,65,()=>s(i),oe,(r,a,u)=>{var c=pe(),v=m(c),g=m(v);P(g);var d=t(t(g,!0));O(d,()=>l(a).aVector.length>0,y=>{var j=ve();P(j),x(()=>j.value=`[${l(a).aVector.length>0&&l(a).aVector.join(", ")}]<`),A(y,j)});var b=t(t(v,!0)),$=m(b);P($);var ee=t(t($,!0));O(ee,()=>l(a).bVector.length>0,y=>{var j=de();P(j),x(()=>j.value=`[${l(a).bVector.length>0&&l(a).bVector.join(", ")}]<`),A(y,j)});var F=t(t(b,!0)),te=m(F);x(()=>E(te,l(a).similarity===0?"(Not Embedded)":l(a).similarity.toFixed(6)));var ae=t(t(F,!0)),re=m(ae);K(g,()=>l(a).a,y=>l(a).a=y),K($,()=>l(a).b,y=>l(a).b=y),C("click",re,()=>G(l(u)),!1),A(r,c)});var z=t(t(N,!0)),B=m(z),Z=t(t(B,!0)),w=t(t(z,!0));O(w,()=>s(h)>0,r=>{var a=_e(),u=m(a);x(()=>E(u,`${T(s(f))}/${T(s(h))} tasks completed`)),A(r,a)}),x(()=>E(X,s(_))),K(S,()=>s(n),r=>p(n,r)),C("click",B,k,!1),C("click",Z,U,!1),A(e,L)}export{qe as component};
