import{h as le,a as k,t as I,c as m,s as t,f as ie}from"../chunks/disclose-version.CHIgA93M.js";import{r as x,s as v,p as ne,a as oe,m as A,F as s,_ as i,$ as B}from"../chunks/runtime.DaZT9Ljh.js";import{b as K,e as $,s as C}from"../chunks/render.DNO9aGB_.js";import{i as E}from"../chunks/if.CrYyXSn7.js";import{e as ue,i as ce}from"../chunks/each.BAEQKuqq.js";import{r as ve}from"../chunks/attributes.C2ZSHPmi.js";import{i as de}from"../chunks/lifecycle.kIdaLNWu.js";function V(e){le&&e.firstChild!==null&&(e.textContent="")}let H=!1;function pe(e,_,n,o=n){e.addEventListener(_,n);const h=e.__on_r;h?e.__on_r=()=>{h(),o()}:e.__on_r=o,H||(H=!0,document.addEventListener("reset",q=>{Promise.resolve().then(()=>{var f;if(!q.defaultPrevented)for(const l of q.target.elements)(f=l.__on_r)==null||f.call(l)})},{capture:!0}))}function O(e,_,n){pe(e,"input",()=>{n(J(e)?R(e.value):e.value)}),x(()=>{var o=_();e.__value=o,!(J(e)&&o===R(e.value))&&(e.type==="date"&&!o&&!e.value||(e.value=K(o)))})}function J(e){var _=e.type;return _==="number"||_==="range"}function R(e){return e===""?null:+e}var _e=I('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),ge=I('<textarea class="vector svelte-1ruqg1j" readonly=""></textarea>'),me=I('<ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"><textarea placeholder="Input your sentence" class="svelte-1ruqg1j"></textarea> <!></li> <li class="svelte-1ruqg1j"> </li> <li class="svelte-1ruqg1j"><button class="svelte-1ruqg1j">Delete</button></li></ul>'),fe=I('<p class="progress svelte-1ruqg1j"> </p>'),be=I('<p class="openai-api-key svelte-1ruqg1j">OpenAI API key</p> <input placeholder="OpenAI API key" class="api-input svelte-1ruqg1j"> <p class="input-error svelte-1ruqg1j"> </p> <ul class="svelte-1ruqg1j"><li class="svelte-1ruqg1j">Sentence1</li> <li class="svelte-1ruqg1j">Sentence2</li> <li class="svelte-1ruqg1j">Cosine Similarity</li> <li class="svelte-1ruqg1j">Delete</li></ul> <!> <div class="buttons svelte-1ruqg1j"><button class="svelte-1ruqg1j">+ Add</button> <button class="execute-button svelte-1ruqg1j">Embeddings</button></div> <!>',1);function Ie(e,_){oe(_,!1);let n=A("");v(n,sessionStorage.getItem("openaiApiKey")||"");let o=A("");const h={};let q=A(0),f=A(0),l=A([{a:"",aVector:[],b:"",bVector:[],similarity:0}]);const G=()=>{v(l,[...s(l),{a:"",aVector:[],b:"",bVector:[],similarity:0}])},Q=r=>{v(l,s(l).filter((a,u)=>u!==r))},T=async r=>{if(h[r])return h[r];const c=(await(await fetch("https://api.openai.com/v1/embeddings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s(n)}`},body:JSON.stringify({input:r,model:"text-embedding-3-small"})})).json()).data[0].embedding;return h[r]=c,c},U=(r,a)=>{const u=(d,g)=>{let p=0;for(let b=0;b<d.length;b++)p+=d[b]*g[b];return p},c=d=>{let g=0;for(let p=0;p<d.length;p++)g+=d[p]*d[p];return Math.sqrt(g)};return u(r,a)/(c(r)*c(a))},W=async()=>{if(v(q,s(l).length),v(f,0),v(o,""),s(n)===""){v(o,"Please input your OpenAI API key");return}sessionStorage.setItem("openaiApiKey",s(n)),s(l).flatMap(async r=>{const[a,u]=await Promise.all([T(r.a),T(r.b)]);v(f,s(f)+1);const c=U(a,u);r.aVector=a,r.bVector=u,r.similarity=c,v(l,[...s(l)])})};de();var D=be(),X=ie(D),P=t(t(X,!0));ve(P);var F=t(t(P,!0)),Y=m(F),Z=t(t(F,!0)),L=t(t(Z,!0));ue(L,1,()=>s(l),ce,(r,a,u)=>{var c=me(),d=m(c),g=m(d);V(g);var p=t(t(g,!0));E(p,()=>i(a).aVector.length>0,y=>{var j=_e();V(j),x(()=>j.value=`[${i(a).aVector.length>0&&i(a).aVector.join(", ")}]<`),k(y,j)});var b=t(t(d,!0)),S=m(b);V(S);var te=t(t(S,!0));E(te,()=>i(a).bVector.length>0,y=>{var j=ge();V(j),x(()=>j.value=`[${i(a).bVector.length>0&&i(a).bVector.join(", ")}]<`),k(y,j)});var z=t(t(b,!0)),ae=m(z);x(()=>C(ae,i(a).similarity===0?"(Not Embedded)":i(a).similarity.toFixed(6)));var re=t(t(z,!0)),se=m(re);O(g,()=>i(a).a,y=>(i(a).a=y,B(()=>s(l)))),O(S,()=>i(a).b,y=>(i(a).b=y,B(()=>s(l)))),$("click",se,()=>Q(i(u)),!1),k(r,c)});var M=t(t(L,!0)),N=m(M),w=t(t(N,!0)),ee=t(t(M,!0));E(ee,()=>s(q)>0,r=>{var a=fe(),u=m(a);x(()=>C(u,`${K(s(f))}/${K(s(q))} tasks completed`)),k(r,a)}),x(()=>C(Y,s(o))),O(P,()=>s(n),r=>v(n,r)),$("click",N,G,!1),$("click",w,W,!1),k(e,D),ne()}export{Ie as component};
